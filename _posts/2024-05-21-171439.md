---
title: "トリリオンエッジグラフの階層的凝集クラスタリングをスケーリングする方法"
categories:
  - 機械学習
tags:
  - クラスタリング
  - アルゴリズム
---
Google Researchによるトリリオンエッジグラフの階層的凝集クラスタリングアルゴリズム「TeraHAC」を解説します。

## 序章
データのクラスタリングは、大規模なデータセットに対しては特に困難です。Google Researchのグラフマイニングチームは、トリリオンエッジに及ぶ巨大なグラフを効率的にクラスタリングできる新しいアルゴリズム「TeraHAC」を開発しました。このアルゴリズムの背後にある主要なアイデアと、そのスケーリング技術を紹介します。

## クラスタリングの挑戦
クラスタリングは、非教師あり学習の一種で、似たアイテムをグループ化することを目的とします。大規模データセットにおいて、これをスケールさせるのは困難です。多くの高品質なクラスタリングアルゴリズムが存在しますが、これらは計算コストが高かったり、並列処理に適していなかったりします。

## サブクラスターコンポーネント（SCC）アルゴリズム[^4]
一例として、SCCアルゴリズムは、各データポイントを最も近い隣接ポイントとクラスタに含め、一定のしきい値を下回るまでこの操作を繰り返します。

## 階層的凝集クラスタリング（HAC）[^1]とその問題点
HACは、貪欲に2つの最も近いクラスタを新しいクラスタにマージする古典的なアルゴリズムです。しかし、過去の実装は二次的な複雑性を持ち、大規模なデータセットには適用が難しいです。

## HACの速度アップ
HACの並列スケーリングを目指して、2021年から新しいアプローチに取り組んできました。特に、スパースなグラフ設定でアルゴリズムを設計し、計算ステップを高いパフォーマンスで実行するための手法を導入しました。その結果、二次的な複雑性を持つ分散HACアルゴリズム「ParHAC」を開発しました[^7]。

## 最後のフロンティア：TeraHAC[^12]
TeraHACは、トリリオンエッジグラフに対して、MapReduceスタイルのアルゴリズムを使用して近似HACを計算する新しいアプローチです。このアルゴリズムは複数のラウンドで進行し、各ラウンドでグラフをサブグラフに分割し、独立してマージを実行します。

### TeraHACアルゴリズムの仕組み
TeraHACは分散された環境で近似HACを計算します。サブグラフごとに部分的なマージを行い、その結果を組み合わせます。トリリオンエッジの巨大なデータセットに対しても、1日以内で高品質な結果を提供することが可能です[^13]。

## 結論
HACはクラシックな手法でありながら、まだ多くの可能性を秘めています。将来的には、動的アルゴリズムや低次元空間での複雑性の解明など、さらなる研究が期待されます。

## 参照URL
[^1]:[Hierarchical Agglomerative Clustering (HAC)](https://en.wikipedia.org/wiki/Hierarchical_clustering)
[^4]:[Sub-Cluster Component (SCC)](https://github.com/nmonath/scc)
[^7]:[Parallel Algorithms](https://ja.wikipedia.org/wiki/%E4%B8%A6%E5%88%97%E3%82%A2%E3%83%AB%E3%82%B4%E3%83%AA%E3%82%BA%E3%83%A0)
[^12]:[Trillion-Edge Graphs](http://www.vldb.org/pvldb/vol12/p2379-hanai.pdf)
[^13]:[Distributed HAC](https://dl.acm.org/doi/10.1145/269005.266666)